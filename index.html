<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="initial-scale=1,user-scalable=no,maximum-scale=1,width=device-width">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">

    <!-- CSS bawaan qgis2web -->
    <link rel="stylesheet" href="./resources/ol.css">
    <link rel="stylesheet" href="./resources/fontawesome-all.min.css">
    <link href="resources/photon-geocoder-autocomplete.min.css" rel="stylesheet">
    <link rel="stylesheet" href="./resources/ol-layerswitcher.css">
    <link rel="stylesheet" href="./resources/qgis2web.css">

    <style>
        html, body {
            background-color: #ffffff;
            margin: 0;
            padding: 0;
        }
        .ol-control > * {
            background-color: #f8f8f8!important;
            color: #444!important;
            border-radius: 0px;
        }
        #map {
            width: 100%;
            height: 90vh;
        }
        #controls {
            padding: 5px;
            background: #f4f4f4;
            border-bottom: 1px solid #ccc;
        }
        select, input {
            padding: 5px;
            margin: 3px;
        }
    </style>

    <title>Peta Kabupaten & Desa Rev</title>
</head>
<body>

<!-- Kontrol Dropdown & Pencarian -->
<div id="controls">
    <label for="kabupatenSelect">Pilih Kabupaten:</label>
    <select id="kabupatenSelect">
        <option value="">-- Pilih Kabupaten --</option>
        <option value="Pacitan_1">Pacitan</option>
        <option value="Ponorogo_2">Ponorogo</option>
        <option value="Trenggalek_3">Trenggalek</option>
        <option value="Tulungagung_4">Tulungagung</option>
        <option value="Blitar_5">Blitar</option>
        <option value="KotaBlitar_6">Kota Blitar</option>
        <option value="Kediri_7">Kediri</option>
        <option value="KotaKediri_8">Kota Kediri</option>
        <option value="Malang_9">Malang</option>
        <option value="KotaMalang_10">Kota Malang</option>
        <option value="Lumajang_11">Lumajang</option>
        <option value="Jember_12">Jember</option>
        <option value="Banyuwangi_13">Banyuwangi</option>
        <option value="Bondowoso_14">Bondowoso</option>
        <option value="Situbondo_15">Situbondo</option>
        <option value="Probolinggo_16">Probolinggo</option>
        <option value="KotaProbolinggo_17">Kota Probolinggo</option>
        <option value="Pasuruan_18">Pasuruan</option>
        <option value="KotaPasuruan_19">Kota Pasuruan</option>
        <option value="Sidoarjo_20">Sidoarjo</option>
        <option value="Mojokerto_21">Mojokerto</option>
        <option value="KotaMojokerto_22">Kota Mojokerto</option>
        <option value="Jombang_23">Jombang</option>
        <option value="Ngajuk_24">Nganjuk</option>
        <option value="Madiun_25">Madiun</option>
        <option value="KotaMadiun_26">Kota Madiun</option>
        <option value="Magetan_27">Magetan</option>
        <option value="Ngawi_28">Ngawi</option>
        <option value="Bojonegoro_29">Bojonegoro</option>
        <option value="Tuban_30">Tuban</option>
        <option value="Lamongan_31">Lamongan</option>
        <option value="Gresik_32">Gresik</option>
        <option value="Bangkalan_33">Bangkalan</option>
        <option value="Sampang_34">Sampang</option>
        <option value="Pamekasan_35">Pamekasan</option>
        <option value="Sumenep_36">Sumenep</option>
        <option value="Surabaya_37">Surabaya</option>
        <option value="Batu_38">Batu</option>
    </select>

    <label for="searchDesa">Cari Desa:</label>
    <input type="text" id="searchDesa" placeholder="Nama desa...">
</div>

<!-- Map -->
<div id="map">
    <div id="popup" class="ol-popup">
        <a href="#" id="popup-closer" class="ol-popup-closer"></a>
        <div id="popup-content"></div>
    </div>
</div>

<!-- Script bawaan qgis2web -->
<script src="resources/qgis2web_expressions.js"></script>
<script src="./resources/functions.js"></script>
<script src="./resources/ol.js"></script>
<script src="./resources/ol-layerswitcher.js"></script>
<script src="resources/photon-geocoder-autocomplete.min.js"></script>

<!-- Semua layers -->
<script src="layers/Pacitan_1.js"></script>
<script src="layers/Ponorogo_2.js"></script>
<script src="layers/Trenggalek_3.js"></script>
<script src="layers/Tulungagung_4.js"></script>
<script src="layers/Blitar_5.js"></script>
<script src="layers/KotaBlitar_6.js"></script>
<script src="layers/Kediri_7.js"></script>
<script src="layers/KotaKediri_8.js"></script>
<script src="layers/Malang_9.js"></script>
<script src="layers/KotaMalang_10.js"></script>
<script src="layers/Lumajang_11.js"></script>
<script src="layers/Jember_12.js"></script>
<script src="layers/Banyuwangi_13.js"></script>
<script src="layers/Bondowoso_14.js"></script>
<script src="layers/Situbondo_15.js"></script>
<script src="layers/Probolinggo_16.js"></script>
<script src="layers/KotaProbolinggo_17.js"></script>
<script src="layers/Pasuruan_18.js"></script>
<script src="layers/KotaPasuruan_19.js"></script>
<script src="layers/Sidoarjo_20.js"></script>
<script src="layers/Mojokerto_21.js"></script>
<script src="layers/KotaMojokerto_22.js"></script>
<script src="layers/Jombang_23.js"></script>
<script src="layers/Ngajuk_24.js"></script>
<script src="layers/Madiun_25.js"></script>
<script src="layers/KotaMadiun_26.js"></script>
<script src="layers/Magetan_27.js"></script>
<script src="layers/Ngawi_28.js"></script>
<script src="layers/Bojonegoro_29.js"></script>
<script src="layers/Tuban_30.js"></script>
<script src="layers/Lamongan_31.js"></script>
<script src="layers/Gresik_32.js"></script>
<script src="layers/Bangkalan_33.js"></script>
<script src="layers/Sampang_34.js"></script>
<script src="layers/Pamekasan_35.js"></script>
<script src="layers/Sumenep_36.js"></script>
<script src="layers/Surabaya_37.js"></script>
<script src="layers/Batu_38.js"></script>

<!-- Semua styles -->
<script src="styles/Pacitan_1_style.js"></script>
<script src="styles/Ponorogo_2_style.js"></script>
<script src="styles/Trenggalek_3_style.js"></script>
<script src="styles/Tulungagung_4_style.js"></script>
<script src="styles/Blitar_5_style.js"></script>
<script src="styles/KotaBlitar_6_style.js"></script>
<script src="styles/Kediri_7_style.js"></script>
<script src="styles/KotaKediri_8_style.js"></script>
<script src="styles/Malang_9_style.js"></script>
<script src="styles/KotaMalang_10_style.js"></script>
<script src="styles/Lumajang_11_style.js"></script>
<script src="styles/Jember_12_style.js"></script>
<script src="styles/Banyuwangi_13_style.js"></script>
<script src="styles/Bondowoso_14_style.js"></script>
<script src="styles/Situbondo_15_style.js"></script>
<script src="styles/Probolinggo_16_style.js"></script>
<script src="styles/KotaProbolinggo_17_style.js"></script>
<script src="styles/Pasuruan_18_style.js"></script>
<script src="styles/KotaPasuruan_19_style.js"></script>
<script src="styles/Sidoarjo_20_style.js"></script>
<script src="styles/Mojokerto_21_style.js"></script>
<script src="styles/KotaMojokerto_22_style.js"></script>
<script src="styles/Jombang_23_style.js"></script>
<script src="styles/Ngajuk_24_style.js"></script>
<script src="styles/Madiun_25_style.js"></script>
<script src="styles/KotaMadiun_26_style.js"></script>
<script src="styles/Magetan_27_style.js"></script>
<script src="styles/Ngawi_28_style.js"></script>
<script src="styles/Bojonegoro_29_style.js"></script>
<script src="styles/Tuban_30_style.js"></script>
<script src="styles/Lamongan_31_style.js"></script>
<script src="styles/Gresik_32_style.js"></script>
<script src="styles/Bangkalan_33_style.js"></script>
<script src="styles/Sampang_34_style.js"></script>
<script src="styles/Pamekasan_35_style.js"></script>
<script src="styles/Sumenep_36_style.js"></script>
<script src="styles/Surabaya_37_style.js"></script>
<script src="styles/Batu_38_style.js"></script>

<!-- Layer list & Autolinker -->
<script src="./layers/layers.js"></script>
<script src="./resources/Autolinker.min.js"></script>

<!-- qgis2web utama -->
<script src="./resources/qgis2web.js"></script>

<!-- Script dropdown & search -->
<script>
document.addEventListener("DOMContentLoaded", function() {
    const kabupatenSelect = document.getElementById('kabupatenSelect');
    const searchInput = document.getElementById('searchDesa');

    kabupatenSelect.addEventListener('change', function() {
        const selected = this.value;
        layersList.forEach(layer => {
            if (layer.get('name') === selected) {
                layer.setVisible(true);
                map.getView().fit(layer.getSource().getExtent(), { duration: 1000 });
            } else {
                layer.setVisible(false);
            }
        });
    });

    searchInput.addEventListener('input', function() {
        const keyword = this.value.toLowerCase();
        layersList.forEach(layer => {
            if (layer.getVisible()) {
                layer.getSource().forEachFeature(function(feature) {
                    const nama = (feature.get('NAMA_DESA') || "").toLowerCase();
                    feature.setStyle(keyword && !nama.includes(keyword) ? null : undefined);
                });
            }
        });
    });
});
</script>
</body>
</html>
