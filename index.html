<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>Peta Kabupaten/Kota Rev22</title>
<link rel="stylesheet" href="resources/ol.css">
<link rel="stylesheet" href="resources/ol-layerswitcher.css">
<link rel="stylesheet" href="resources/choices.min.css">
<style>
    html, body {
        margin: 0;
        padding: 0;
        height: 100%;
        background: #fff;
    }
    #kabupatenSelect {
        position: absolute;
        top: 10px;
        left: 10px;
        z-index: 1000;
        width: 300px;
    }
    #map {
        width: 100%;
        height: 100%;
    }
</style>
</head>
<body>

<!-- Dropdown Kabupaten/Kota -->
<select id="kabupatenSelect" placeholder="Pilih Kabupaten/Kota"></select>

<!-- Peta -->
<div id="map">
    <div id="popup" class="ol-popup">
        <a href="#" id="popup-closer" class="ol-popup-closer"></a>
        <div id="popup-content"></div>
    </div>
</div>

<!-- Library OpenLayers dan LayerSwitcher -->
<script src="resources/ol.js"></script>
<script src="resources/ol-layerswitcher.js"></script>

<!-- Library tambahan -->
<script src="resources/qgis2web_expressions.js"></script>
<script src="resources/functions.js"></script>

<!-- Semua file layer hasil export -->
<script src="layers/Pacitan_1.js"></script>
<script src="layers/Ponorogo_2.js"></script>
<script src="layers/Trenggalek_3.js"></script>
<script src="layers/Tulungagung_4.js"></script>
<script src="layers/Blitar_5.js"></script>
<script src="layers/KotaBlitar_6.js"></script>
<script src="layers/Kediri_7.js"></script>
<script src="layers/KotaKediri_8.js"></script>
<script src="layers/Malang_9.js"></script>
<script src="layers/KotaMalang_10.js"></script>
<script src="layers/Lumajang_11.js"></script>
<script src="layers/Jember_12.js"></script>
<script src="layers/Banyuwangi_13.js"></script>
<script src="layers/Bondowoso_14.js"></script>
<script src="layers/Situbondo_15.js"></script>
<script src="layers/Probolinggo_16.js"></script>
<script src="layers/KotaProbolinggo_17.js"></script>
<script src="layers/Pasuruan_18.js"></script>
<script src="layers/KotaPasuruan_19.js"></script>
<script src="layers/Sidoarjo_20.js"></script>
<script src="layers/Mojokerto_21.js"></script>
<script src="layers/KotaMojokerto_22.js"></script>
<script src="layers/Jombang_23.js"></script>
<script src="layers/Ngajuk_24.js"></script>
<script src="layers/Madiun_25.js"></script>
<script src="layers/KotaMadiun_26.js"></script>
<script src="layers/Magetan_27.js"></script>
<script src="layers/Ngawi_28.js"></script>
<script src="layers/Bojonegoro_29.js"></script>
<script src="layers/Tuban_30.js"></script>
<script src="layers/Lamongan_31.js"></script>
<script src="layers/Gresik_32.js"></script>
<script src="layers/Bangkalan_33.js"></script>
<script src="layers/Sampang_34.js"></script>
<script src="layers/Pamekasan_35.js"></script>
<script src="layers/Sumenep_36.js"></script>
<script src="layers/Surabaya_37.js"></script>
<script src="layers/Batu_38.js"></script>
<script src="layers/BatasKabupaten_39.js"></script>

<!-- Semua file style hasil export -->
<script src="styles/Pacitan_1_style.js"></script>
<script src="styles/Ponorogo_2_style.js"></script>
<script src="styles/Trenggalek_3_style.js"></script>
<script src="styles/Tulungagung_4_style.js"></script>
<script src="styles/Blitar_5_style.js"></script>
<script src="styles/KotaBlitar_6_style.js"></script>
<script src="styles/Kediri_7_style.js"></script>
<script src="styles/KotaKediri_8_style.js"></script>
<script src="styles/Malang_9_style.js"></script>
<script src="styles/KotaMalang_10_style.js"></script>
<script src="styles/Lumajang_11_style.js"></script>
<script src="styles/Jember_12_style.js"></script>
<script src="styles/Banyuwangi_13_style.js"></script>
<script src="styles/Bondowoso_14_style.js"></script>
<script src="styles/Situbondo_15_style.js"></script>
<script src="styles/Probolinggo_16_style.js"></script>
<script src="styles/KotaProbolinggo_17_style.js"></script>
<script src="styles/Pasuruan_18_style.js"></script>
<script src="styles/KotaPasuruan_19_style.js"></script>
<script src="styles/Sidoarjo_20_style.js"></script>
<script src="styles/Mojokerto_21_style.js"></script>
<script src="styles/KotaMojokerto_22_style.js"></script>
<script src="styles/Jombang_23_style.js"></script>
<script src="styles/Ngajuk_24_style.js"></script>
<script src="styles/Madiun_25_style.js"></script>
<script src="styles/KotaMadiun_26_style.js"></script>
<script src="styles/Magetan_27_style.js"></script>
<script src="styles/Ngawi_28_style.js"></script>
<script src="styles/Bojonegoro_29_style.js"></script>
<script src="styles/Tuban_30_style.js"></script>
<script src="styles/Lamongan_31_style.js"></script>
<script src="styles/Gresik_32_style.js"></script>
<script src="styles/Bangkalan_33_style.js"></script>
<script src="styles/Sampang_34_style.js"></script>
<script src="styles/Pamekasan_35_style.js"></script>
<script src="styles/Sumenep_36_style.js"></script>
<script src="styles/Surabaya_37_style.js"></script>
<script src="styles/Batu_38_style.js"></script>
<script src="styles/BatasKabupaten_39_style.js"></script>

<!-- layers.js dan qgis2web.js -->
<script src="layers/layers.js"></script>
<script src="resources/qgis2web.js"></script>

<!-- Choices.js untuk dropdown -->
<script src="resources/choices.min.js"></script>

<!-- Script Dropdown & Hover -->
<script>
document.addEventListener("DOMContentLoaded", function() {
    const selectElem = document.getElementById("kabupatenSelect");

    // Ambil semua layer kabupaten/kota (kecuali batas)
    const kabupatenLayers = layersList.filter(l => l.get('title') && !l.get('title').includes('Batas'));

    // Ambil nama kabupaten dari title layer
    const kabupatenNames = kabupatenLayers.map(l => l.get('title')).sort();

    // Isi dropdown
    kabupatenNames.forEach(name => {
        let option = document.createElement("option");
        option.value = name;
        option.textContent = name;
        selectElem.appendChild(option);
    });

    // Aktifkan pencarian di dropdown
    const choices = new Choices('#kabupatenSelect', { searchEnabled: true, itemSelectText: '' });

    // Zoom ke kabupaten saat dipilih
    selectElem.addEventListener("change", function() {
        let selectedName = this.value;
        kabupatenLayers.forEach(layer => {
            if (layer.get('title') === selectedName) {
                let src = layer.getSource();
                if (src && src.getFeatures().length > 0) {
                    let extent = src.getExtent();
                    map.getView().fit(extent, { duration: 1000, padding: [50,50,50,50] });
                }
            }
        });
    });

    // Hover efek kuning
    let hoverInteraction = new ol.interaction.Select({
        condition: ol.events.condition.pointerMove,
        layers: kabupatenLayers,
        style: new ol.style.Style({
            stroke: new ol.style.Stroke({ color: 'yellow', width: 2 }),
            fill: new ol.style.Fill({ color: 'rgba(255, 255, 0, 0.3)' })
        })
    });
    map.addInteraction(hoverInteraction);
});
</script>

</body>
</html>
